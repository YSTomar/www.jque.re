(function(b){b.foobar=function(a){typeof a=="string"&&(a={messages:[a]});a=b.extend(!0,{},defaults,a);bar.apply(a)};b.foobarGoogleCallback=function(){bar.loadFeeds()};defaults={height:30,collapsedButtonHeight:30,positioning:"fixed",backgroundColor:"IndianRed",border:"solid 3px #FFF",buttonTheme:"triangle-arrow",display:"expanded",displayDelay:0,speed:100,messages:["Foobar! The simple info bar!"],messagesDelay:2000,messagesFadeDelay:500,enableCookie:!1,positionClose:"right",positionSocial:"left",messageClass:"",fontFamily:"Verdana",fontSize:"10pt",fontColor:"White",aFontFamily:"Verdana",aFontSize:"10pt",aFontColor:"LightYellow",aFontDecoration:"underline",social:{text:"Follow us:",fontFamily:"Verdana",fontSize:"10pt",fontColor:"White",profiles:[]},rss:{enabled:!1,googleAPIKey:"",url:"http://my-domain.com/rss",maxResults:5,linkText:"Read More",linkTarget:"_blank"}};bar={settings:{},wrapper:null,container:null,shadow:null,left:null,center:null,right:null,closeButtonContainer:null,closeButton:null,openButtonContainer:null,openButton:null,initialized:!1,isOpen:!1,htmlMarginTop:0,messageTimeoutId:null,messageIndex:0,initialize:function(){var a=b("html");bar.htmlMarginTop=parseInt(a.css("margin-top"));bar.htmlMarginTop=isNaN(bar.htmlMarginTop)?0:bar.htmlMarginTop;b(".foobar-wrapper").length==0?(bar.wrapper=b("<div/>").addClass("foobar-wrapper"),bar.container=b("<div/>").addClass("foobar-container"),bar.shadow=b("<div/>").addClass("foobar-shadow"),bar.left=b("<div/>").addClass("foobar-container-left"),bar.center=b("<div/>").addClass("foobar-container-center"),bar.right=b("<div/>").addClass("foobar-container-right"),bar.closeButtonContainer=b("<div/>").addClass("foobar-close-button-container"),bar.closeButton=b("<a/>").attr("href","#close-foobar").addClass("foobar-close-button").text(" "),bar.openButtonContainer=b("<div/>").addClass("foobar-open-button-container"),bar.openButton=b("<a/>").attr("href","#open-foobar").addClass("foobar-open-button").text(" "),bar.addTo("body")):(bar.wrapper=b(".foobar-wrapper"),bar.container=b(".foobar-container"),bar.shadow=b(".foobar-shadow"),bar.left=b(".foobar-container-left"),bar.center=b(".foobar-container-center"),bar.right=b(".foobar-container-right"),bar.closeButtonContainer=b(".foobar-close-button-container"),bar.closeButton=b(".foobar-close-button").text(" "),bar.openButtonContainer=b(".foobar-open-button-container"),bar.openButton=b(".foobar-open-button").text(" "));bar.initialized=!0},setCookie:function(a,b,e){if(e){var c=new Date;c.setTime(c.getTime()+e*86400000);e="; expires="+c.toGMTString()}else{e=""}document.cookie=a+"="+b+e+"; path=/"},getCookie:function(a){a+="=";for(var b=document.cookie.split(";"),e=0;e<b.length;e++){for(var c=b[e];c.charAt(0)==" ";){c=c.substring(1,c.length)}if(c.indexOf(a)==0){return c.substring(a.length,c.length)}}return null},deleteCookie:function(a){bar.setCookie(a,"",-1)},addTo:function(a){b(a).prepend(bar.wrapper);bar.wrapper.append(bar.container).append(bar.shadow).append(bar.openButtonContainer);bar.container.append(bar.closeButtonContainer).append(bar.left).append(bar.center).append(bar.right);bar.closeButtonContainer.append(bar.closeButton);bar.openButtonContainer.append(bar.openButton)},isNotNullOrEmpty:function(a){return typeof a=="string"&&a!=null&&a!=""},messageCycle:function(){bar.settings.messages.length==1?bar.clearMessageTimeout():bar.center.animate({opacity:0},bar.settings.messagesFadeDelay/2,function(){bar.center.html(bar.settings.messages[bar.messageIndex]);if(!bar.isNotNullOrEmpty(bar.settings.messageClass)){var a=bar.center.find("a");bar.isNotNullOrEmpty(bar.settings.aFontFamily)&&a.css("font-family",bar.settings.aFontFamily);bar.isNotNullOrEmpty(bar.settings.aFontSize)&&a.css("font-size",bar.settings.aFontSize);bar.isNotNullOrEmpty(bar.settings.aFontColor)&&a.css("color",bar.settings.aFontColor);bar.isNotNullOrEmpty(bar.settings.aFontDecoration)&&a.css("text-decoration",bar.settings.aFontDecoration)}bar.messageIndex==bar.settings.messages.length-1?bar.messageIndex=0:bar.messageIndex++;bar.center.animate({opacity:100},bar.settings.messagesFadeDelay/2,function(){bar.messageTimeoutId=setTimeout(bar.messageCycle,bar.settings.messagesDelay)})})},clearMessageTimeout:function(){if(typeof bar.messageTimeoutId!="undefined"&&bar.messageTimeoutId!=null){clearTimeout(bar.messageTimeoutId),bar.messageTimeoutId=null}},setMessageTimeout:function(){clearMessageTimeout();if(bar.messageTimeoutId==null){bar.messageTimeoutId=setTimeout(bar.messageCycle,bar.settings.messagesDelay)}},isGoogleLoaded:function(){var a=!1;b('head > script[type="text/javascript"]').each(function(){var d=b(this).attr("src");bar.isNotNullOrEmpty(d)&&d.length>=32&&d.substr(0,32)==="http://www.google.com/jsapi?key="&&(a=!0)});return a&&typeof google!="undefined"},isFeedsLoaded:function(){return bar.isGoogleLoaded()&&typeof google.feeds!="undefined"},loadGoogle:function(){var a=document.createElement("script");a.src="http://www.google.com/jsapi?key="+bar.settings.rss.googleAPIKey+"&callback=jQuery.foobarGoogleCallback";a.type="text/javascript";document.getElementsByTagName("head")[0].appendChild(a)},loadFeeds:function(){google.load("feeds","1",{callback:bar.loadRss})},loadRss:function(){var a=new google.feeds.Feed(bar.settings.rss.url);a.setNumEntries(bar.settings.rss.maxResults);a.load(function(a){bar.clearMessageTimeout();if(!a.error){for(var b=0;b<a.feed.entries.length;b++){var c=a.feed.entries[b].title;bar.isNotNullOrEmpty(bar.settings.rss.linkText)&&(c+=' <a href="'+a.feed.entries[b].link+'" target="'+bar.settings.rss.linkTarget+'">'+bar.settings.rss.linkText+"</a>");bar.settings.messages.push(c)}}bar.center.html(bar.settings.messages[0]);if(bar.settings.messages.length>1){bar.messageIndex=1,bar.messageTimeoutId=setTimeout(bar.messageCycle,bar.settings.messagesDelay)}})},expand:function(a){typeof a!="undefined"&&a!=null&&typeof a.preventDefault=="function"&&a.preventDefault();if(!bar.isOpen){bar.openButtonContainer.animate({height:0},bar.settings.speed,function(){bar.container.animate({height:bar.settings.height},bar.settings.speed).css({"border-bottom":bar.settings.border});bar.wrapper.animate({height:bar.settings.height+5},bar.settings.speed);bar.settings.positioning=="fixed"?b("html").animate({"margin-top":"+="+(bar.settings.height+5)}):b("html").css({"margin-top":bar.htmlMarginTop+"px"});bar.wrapper.focus()}),bar.isOpen=!0,bar.settings.enableCookie&&bar.setCookie("foobar-expanded",!0,1)}},collapse:function(a){typeof a!="undefined"&&a!=null&&typeof a.preventDefault=="function"&&a.preventDefault();if(bar.isOpen){bar.container.animate({height:0},bar.settings.speed).css({border:"none"}),bar.settings.positioning=="fixed"?b("html").animate({"margin-top":"-="+(bar.settings.height+5)}):b("html").css({"margin-top":bar.htmlMarginTop+"px"}),bar.wrapper.animate({height:5},bar.settings.speed,function(){bar.openButtonContainer.animate({height:bar.settings.collapsedButtonHeight+11},bar.settings.speed)}),bar.isOpen=!1,bar.settings.enableCookie&&bar.setCookie("foobar-expanded",!1,1)}},setExpanded:function(){bar.container.height(bar.settings.height).css({"border-bottom":bar.settings.border});bar.wrapper.height(bar.settings.height+5);bar.openButtonContainer.height(0);bar.settings.positioning=="fixed"?b("html").css({"margin-top":bar.htmlMarginTop<=0?bar.settings.height+5+"px":bar.htmlMarginTop+(bar.settings.height+5)+"px"}):b("html").css({"margin-top":bar.htmlMarginTop+"px"});bar.isOpen=!0;bar.settings.enableCookie&&bar.setCookie("foobar-expanded",!0,1)},setCollapsed:function(){bar.container.height(0).css({"border-bottom":0});bar.wrapper.height(5);bar.openButtonContainer.height(bar.settings.collapsedButtonHeight+11);bar.settings.positioning=="fixed"?b("html").css({"margin-top":bar.htmlMarginTop<=0?"0px":bar.htmlMarginTop-(bar.settings.height+5)+"px"}):b("html").css({"margin-top":bar.htmlMarginTop+"px"});bar.isOpen=!1;bar.settings.enableCookie&&bar.setCookie("foobar-expanded",!1,1)},apply:function(a){wasinit=!0;bar.settings=a;bar.initialized||(bar.initialize(),wasinit=!1);bar.wrapper.css({height:bar.settings.height+5});bar.openButtonContainer.css({height:bar.settings.collapsedButtonHeight+11});bar.openButton.css({height:bar.settings.collapsedButtonHeight});bar.container.add(bar.right).add(bar.left).add(bar.center).add(bar.closeButtonContainer).add(bar.closeButton).css({height:bar.settings.height});bar.right.add(bar.left).add(bar.center).css({"line-height":bar.settings.height+"px"});bar.container.add(bar.openButton).css({"background-color":bar.settings.backgroundColor});bar.container.css({"border-bottom":bar.settings.border});bar.openButton.css({border:bar.settings.border,"border-top":"none"});bar.openButtonContainer.css({top:bar.htmlMarginTop+"px"});bar.openButton.add(bar.closeButton).removeClass();bar.openButton.addClass("foobar-open-button");bar.closeButton.addClass("foobar-close-button");bar.openButton.add(bar.closeButton).addClass(a.buttonTheme);bar.isNotNullOrEmpty(bar.settings.messageClass)?bar.center.addClass(bar.settings.messageClass):(bar.isNotNullOrEmpty(bar.settings.fontFamily)&&bar.center.css("font-family",bar.settings.fontFamily),bar.isNotNullOrEmpty(bar.settings.fontSize)&&bar.center.css("font-size",bar.settings.fontSize),bar.isNotNullOrEmpty(bar.settings.fontColor)&&bar.center.css("color",bar.settings.fontColor));bar.settings.rss.enabled&&bar.isNotNullOrEmpty(bar.settings.rss.googleAPIKey)&&bar.isNotNullOrEmpty(bar.settings.rss.url)&&(bar.isGoogleLoaded()&&bar.isFeedsLoaded()?bar.loadRss():bar.isFeedsLoaded()?bar.loadFeeds():bar.loadGoogle());bar.clearMessageTimeout();if(bar.settings.messages.length==1){bar.center.html(bar.settings.messages[0]),bar.messageIndex=1,bar.isNotNullOrEmpty(bar.settings.messageClass)||(a=bar.center.find("a"),bar.isNotNullOrEmpty(bar.settings.aFontFamily)&&a.css("font-family",bar.settings.aFontFamily),bar.isNotNullOrEmpty(bar.settings.aFontSize)&&a.css("font-size",bar.settings.aFontSize),bar.isNotNullOrEmpty(bar.settings.aFontColor)&&a.css("color",bar.settings.aFontColor),bar.isNotNullOrEmpty(bar.settings.aFontDecoration)&&a.css("text-decoration",bar.settings.aFontDecoration))}else{if(bar.settings.messages.length>1&&(bar.center.hover(bar.clearMessageTimeout,bar.setMessageTimeout),!wasinit)){bar.center.html(bar.settings.messages[0]),bar.messageIndex=1,bar.messageTimeoutId=setTimeout(bar.messageCycle,bar.settings.messagesDelay)}}if(bar.settings.positionSocial=="left"||bar.settings.positionSocial=="right"){if(bar.settings.social.profiles.length>0){var d=b(".foobar-social").length>0?b(".foobar-social"):b("<ul/>").addClass("foobar-social");d.empty();a=b("<li/>").text(bar.settings.social.text).css({height:bar.settings.height,"line-height":bar.settings.height+"px"});bar.isNotNullOrEmpty(bar.settings.socialClass)?a.addClass(bar.settings.socialClass):(a.css({"padding-right":"10px","padding-left":"10px"}),bar.isNotNullOrEmpty(bar.settings.social.fontFamily)&&a.css("font-family",bar.settings.social.fontFamily),bar.isNotNullOrEmpty(bar.settings.social.fontSize)&&a.css("font-size",bar.settings.social.fontSize),bar.isNotNullOrEmpty(bar.settings.social.fontColor)&&a.css("color",bar.settings.social.fontColor));d.append(a);pdef={name:null,url:null,image:null};b.each(bar.settings.social.profiles,function(a,c){profile=b.extend({},pdef,c);if(profile.name!=null&&profile.url!=null&&profile.image!=null){var f=b("<a/>").attr("href",profile.url).attr("title",profile.name).css({background:"url('"+profile.image+"') no-repeat center center",height:bar.settings.height});d.append(b("<li/>").css({height:bar.settings.height}).append(f))}});bar.settings.positionSocial=="right"?(d.css("float","right"),bar.right.append(d)):bar.settings.positionSocial=="left"&&(d.css("float","left"),bar.left.append(d))}else{b(".foobar-social").remove()}}else{b(".foobar-social").remove()}bar.settings.positioning=="fixed"?(bar.wrapper.css({position:"fixed",top:bar.htmlMarginTop+"px",left:"0px"}),bar.openButtonContainer.css({position:"fixed"})):(bar.wrapper.css({position:"relative",top:0,left:0}),bar.openButtonContainer.css({position:"absolute"}));bar.settings.positionClose=="right"?(bar.left.css("width","25%"),bar.right.css("width","20%"),bar.closeButtonContainer.css("float","right"),bar.openButtonContainer.css({left:"auto",right:"0px"})):bar.settings.positionClose=="left"?(bar.left.css("width","20%"),bar.right.css("width","25%"),bar.closeButtonContainer.css("float","left"),bar.openButtonContainer.css({right:"auto",left:"0px"})):(bar.left.css("width","25%"),bar.right.css("width","25%"));a=bar.getCookie("foobar-state");if(a==null||!bar.settings.enableCookie){switch(bar.settings.enableCookie||bar.deleteCookie("foobar-state"),bar.settings.display){case"onscroll":bar.setCollapsed();b(window).one("scroll",function(){setTimeout(bar.expand,bar.settings.displayDelay)});break;case"delayed":bar.setCollapsed();setTimeout(bar.expand,bar.settings.displayDelay);break;case"collapsed":bar.setCollapsed();break;default:bar.setExpanded()}}else{a=="true"?bar.setExpanded():bar.setCollapsed()}bar.openButton.unbind().click(bar.expand);bar.closeButton.unbind().click(bar.collapse)}}})(jQuery);