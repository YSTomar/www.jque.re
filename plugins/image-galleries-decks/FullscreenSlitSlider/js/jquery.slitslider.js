(function($,undefined){var $event=$.event,resizeTimeout;$event.special.smartresize={setup:function(){$(this).bind("resize",$event.special.smartresize.handler)},teardown:function(){$(this).unbind("resize",$event.special.smartresize.handler)},handler:function(event,execAsap){var context=this,args=arguments;event.type="smartresize";if(resizeTimeout){clearTimeout(resizeTimeout)}resizeTimeout=setTimeout(function(){jQuery.event.handle.apply(context,args)},execAsap==="execAsap"?0:100)}};$.fn.smartresize=function(fn){return fn?this.bind("smartresize",fn):this.trigger("smartresize",["execAsap"])};$.Slitslider=function(options,element){this.$slider=$(element);this._init(options)};$.Slitslider.defaults={speed:1000,autoplay:false,interval:4000,optOpacity:false,translateF:230,maxAngle:25,maxScale:2};$.Slitslider.prototype={_init:function(options){this.options=$.extend(true,{},$.Slitslider.defaults,options);this.$slides=this.$slider.children(".sl-slide").hide();this.slidesCount=this.$slides.length;this.current=0;this.isAnimating=false;this._getWinSize();this._layout();this._loadEvents();if(this.options.autoplay){this._startSlideshow()}},_getWinSize:function(){var $win=$(window);this.windowProp={width:$win.width(),height:$win.height()}},_layout:function(){this.$slideWrapper=$('<div class="sl-slides-wrapper" />');this.$slides.wrapAll(this.$slideWrapper).each(function(i){var $slide=$(this),orientation=$slide.data("orientation");$slide.addClass("sl-slide-"+orientation).children().wrapAll('<div class="sl-content-wrapper" />').wrapAll('<div class="sl-content" />')});this._setSize();this.$slides.eq(this.current).show();if(this.slidesCount>1){this.$slider.append('<nav><span class="sl-prev">Previous</span><span class="sl-next">Next</span></nav>')}},_setSize:function(){var css={width:this.windowProp.width,height:this.windowProp.height};this.$slider.css(css).find("div.sl-content-wrapper").css(css)},_loadEvents:function(){var _self=this;if(this.slidesCount>1){this.$slider.find("nav > span.sl-prev").on("click.slitslider",function(event){if(_self.options.autoplay){clearTimeout(_self.slideshow);_self.options.autoplay=false}_self._navigate("out")}).end().find("nav > span.sl-next").on("click.slitslider",function(event){if(_self.options.autoplay){clearTimeout(_self.slideshow);_self.options.autoplay=false}_self._navigate("in")})}$(window).on("smartresize.slitslider",function(event){_self._getWinSize();_self._setSize()})},_navigate:function(dir){if(this.isAnimating){return false}var _self=this;this.isAnimating=true;var $currentSlide=this.$slides.eq(this.current),css;(dir==="in")?((this.current<this.slidesCount-1)?++this.current:this.current=0):((this.current>0)?--this.current:this.current=this.slidesCount-1);var $nextSlide=this.$slides.eq(this.current).show(),$movingSlide=(dir==="in")?$currentSlide:$nextSlide,orientation=$movingSlide.data("orientation")||"horizontal",cut1angle=$movingSlide.data("cut1Rotation")||0,cut1scale=$movingSlide.data("cut1Scale")||1,cut2angle=$movingSlide.data("cut2Rotation")||0,cut2scale=$movingSlide.data("cut2Scale")||1;this._validateValues(cut1angle,cut2angle,cut1scale,cut2scale,orientation);if(orientation==="vertical"){css={marginLeft:-this.windowProp.width/2}}else{if(orientation==="horizontal"){css={marginTop:-this.windowProp.height/2}}}var resetStyle=(orientation==="horizontal")?{x:"0%",y:"0%",rotate:0,scale:1,opacity:1}:{x:"0%",y:"0%",rotate:0,scale:1,opacity:1},cut1Style=(orientation==="horizontal")?{y:"-"+this.options.translateF+"%",rotate:cut1angle,scale:cut1scale}:{x:"-"+this.options.translateF+"%",rotate:cut1angle,scale:cut1scale},cut2Style=(orientation==="horizontal")?{y:this.options.translateF+"%",rotate:cut2angle,scale:cut2scale}:{x:this.options.translateF+"%",rotate:cut2angle,scale:cut2scale};if(this.options.optOpacity){cut1Style.opacity=0;cut2Style.opacity=0}(dir==="in")?$nextSlide.addClass("sl-trans-elems"):$currentSlide.addClass("sl-trans-back-elems");$currentSlide.removeClass("sl-trans-elems");$movingSlide.css("z-index",this.slidesCount).find("div.sl-content-wrapper").wrap('<div class="sl-content-cut" />').parent().cond(dir==="out",function(){this.css(cut1Style).transition(resetStyle,_self.options.speed,dir)},function(){this.transition(cut1Style,_self.options.speed,dir)}).clone().appendTo($movingSlide).cond(dir==="out",function(){var cut=this;cut.css(cut2Style).transition(resetStyle,_self.options.speed,dir,function(){_self._onEndNavigate(cut,$currentSlide,dir)})},function(){var cut=this;cut.transition(cut2Style,_self.options.speed,dir,function(){_self._onEndNavigate(cut,$currentSlide,dir)})}).find("div.sl-content-wrapper").css(css)},_validateValues:function(cut1angle,cut2angle,cut1scale,cut2scale,orientation){if(cut1angle>this.options.maxAngle||cut1angle<-this.options.maxAngle){cut1angle=this.options.maxAngle}if(cut2angle>this.options.maxAngle||cut2angle<-this.options.maxAngle){cut2angle=this.options.maxAngle}if(cut1scale>this.options.maxScale||cut1scale<=0){cut1scale=this.options.maxScale}if(cut2scale>this.options.maxScale||cut2scale<=0){cut2scale=this.options.maxScale}if(orientation!=="vertical"&&orientation!=="horizontal"){orientation="horizontal"}},_onEndNavigate:function($slice,$oldSlide,dir){var $slide=$slice.parent(),removeClasses="sl-trans-elems sl-trans-back-elems";$slice.remove();$slide.css("z-index",1).find("div.sl-content-wrapper").unwrap();$oldSlide.hide().removeClass(removeClasses);$slide.removeClass(removeClasses);this.isAnimating=false},_startSlideshow:function(){var _self=this;this.slideshow=setTimeout(function(){_self._navigate("in");if(_self.options.autoplay){_self._startSlideshow()}},this.options.interval)},};var logError=function(message){if(this.console){console.error(message)}};$.fn.slitslider=function(options){if(typeof options==="string"){var args=Array.prototype.slice.call(arguments,1);this.each(function(){var instance=$.data(this,"slitslider");if(!instance){logError("cannot call methods on slitslider prior to initialization; attempted to call method '"+options+"'");return}if(!$.isFunction(instance[options])||options.charAt(0)==="_"){logError("no such method '"+options+"' for slitslider instance");return}instance[options].apply(instance,args)})}else{this.each(function(){var instance=$.data(this,"slitslider");if(!instance){$.data(this,"slitslider",new $.Slitslider(options,this))}})}return this}})(jQuery);